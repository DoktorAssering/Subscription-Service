# Subscription Service

REST-—Å–µ—Ä–≤–∏—Å –Ω–∞ Go –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ–± –æ–Ω–ª–∞–π–Ω-–ø–æ–¥–ø–∏—Å–∫–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/your-org/subscription-service.git
cd subscription-service
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –ø—Ä–∏–º–µ—Ä–∞ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```bash
cp .env.example .env
# –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –≤—Ä—É—á–Ω—É—é .env —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:
# DB_HOST=localhost
# DB_PORT=5432
# DB_USER=postgres
# DB_PASSWORD=postgres
# DB_NAME=subscriptions
```

### 3. –ó–∞–ø—É—Å–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Docker

```bash
docker compose up -d
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä PostgreSQL –∑–∞–ø—É—â–µ–Ω –∏ —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 5432 (–õ–∏–±–æ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ .env + docker-compose.yml).

### 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Swagger

```bash
# –°–∫–∞—á–∏–≤–∞–µ–º –º–æ–¥—É–ª–∏ Go
go mod tidy

# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Swagger (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ cmd/main.go)
swag init -g cmd/main.go
```

### 5. –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä—è–º–æ —á–µ—Ä–µ–∑ Go
go run ./cmd/main.go
```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:8080`.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
subscription-service/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ main.go            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ config.go          # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î –∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ handler/
‚îÇ   ‚îî‚îÄ‚îÄ subscription.go    # HTTP-—Ä—É—á–∫–∏
‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îî‚îÄ‚îÄ subscription.go    # –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îî‚îÄ‚îÄ subscription.go    # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îî‚îÄ‚îÄ subscription.go    # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ docs/                  # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Swagger-—Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ Dockerfile             # –°–±–æ—Ä–∫–∞ Go-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docker-compose.yml     # –ü–æ–¥—ä—ë–º –ë–î
‚îú‚îÄ‚îÄ .env.example           # –ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ go.mod
‚îî‚îÄ‚îÄ README.md
```

---

## üìã API Endpoints

|  –ú–µ—Ç–æ–¥ | –ü—É—Ç—å                   | –û–ø–∏—Å–∞–Ω–∏–µ                        |
| -----: | :--------------------- | :------------------------------ |
|   POST | `/subscriptions`       | –°–æ–∑–¥–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É                |
|    GET | `/subscriptions`       | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–¥–ø–∏—Å–æ–∫        |
|    GET | `/subscriptions/{id}`  | –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –ø–æ ID         |
|    PUT | `/subscriptions/{id}`  | –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É               |
| DELETE | `/subscriptions/{id}`  | –£–¥–∞–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É                |
|    GET | `/subscriptions/total` | –°—É–º–º–∞—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º |

### –ü—Ä–∏–º–µ—Ä —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ (POST /subscriptions)

```json
{
  "service_name": "Netflix",
  "price": 12.99,
  "user_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
  "start_date": "2025-07-22"
}
```

### –ü—Ä–∏–º–µ—Ä –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

```
GET /subscriptions/total?service=Netflix&userId=3fa85f64-5717-4562-b3fc-2c963f66afa6
```

–û—Ç–≤–µ—Ç:

```json
{ "total_price": 12.99 }
```

---

## üîß –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

* **Swagger UI**: [http://localhost:8080/swagger/index.html](http://localhost:8080/swagger/index.html)

* **curl**:

  ```bash
  curl -X POST http://localhost:8080/subscriptions \
    -H "Content-Type: application/json" \
    -d '{ "service_name":"Netflix","price":12.99,"user_id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","start_date":"2025-07-22" }'
  ```

* **Postman**: –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é –∏–∑ –ø–∞–ø–∫–∏ `postman/Subscription API.json` (–µ—Å–ª–∏ –µ—Å—Ç—å).

---

## üõ†Ô∏è –û—Ç–ª–∞–¥–∫–∞ –∏ —Å–æ–≤–µ—Ç—ã

* –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ-–º–∏–≥—Ä–∞—Ü–∏–∏ (`db.AutoMigrate`).
* –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ `DB_HOST/DB_PORT`.
* –í —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫ –º–æ–¥—É–ª–µ–π Go ‚Äî –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `go clean -modcache && go mod tidy`.
